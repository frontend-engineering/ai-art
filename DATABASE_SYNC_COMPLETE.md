# æ•°æ®åº“åŒæ­¥å®ŒæˆæŠ¥å‘Š

## æ‰§è¡Œæ—¶é—´
2026-01-28

---

## âœ… ä»»åŠ¡å®Œæˆæƒ…å†µ

### 1. æ ¸å¿ƒä¸šåŠ¡è¡¨åŒæ­¥
æ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡è¡¨å·²ä¸ç”Ÿäº§ç¯å¢ƒå®Œå…¨åŒæ­¥ï¼š
- users (23ä¸ªå­—æ®µ)
- payment_orders (16ä¸ªå­—æ®µ)
- product_orders, generation_history, greeting_cards
- refunds, payment_logs, membership_plans, traffic_stats, error_logs

### 2. ç®¡ç†åå°è¡¨éƒ¨ç½²
å·²æˆåŠŸéƒ¨ç½²6å¼ ç®¡ç†åå°è¡¨åˆ°ç”Ÿäº§ç¯å¢ƒï¼š
- âœ… admin_users - ç®¡ç†å‘˜ç”¨æˆ·è¡¨
- âœ… admin_operation_logs - æ“ä½œæ—¥å¿—è¡¨
- âœ… price_configs - ä»·æ ¼é…ç½®è¡¨ï¼ˆå«5æ¡åˆå§‹æ•°æ®ï¼‰
- âœ… price_history - ä»·æ ¼å†å²è¡¨
- âœ… system_configs - ç³»ç»Ÿé…ç½®è¡¨
- âœ… template_configs - æ¨¡æ¿é…ç½®è¡¨

### 3. é‚€è¯·ç³»ç»Ÿè¡¨éƒ¨ç½²
å·²æˆåŠŸéƒ¨ç½²é‚€è¯·å’Œä½¿ç”¨æ¬¡æ•°ç³»ç»Ÿç›¸å…³è¡¨ï¼š
- âœ… invite_records - é‚€è¯·è®°å½•è¡¨
- âœ… invite_stats - é‚€è¯·ç»Ÿè®¡è¡¨
- âœ… usage_logs - ä½¿ç”¨æ¬¡æ•°æ—¥å¿—è¡¨

### 4. æ•°æ®åº“è¿ç§»è®°å½•
ç”Ÿäº§ç¯å¢ƒå·²æ‰§è¡Œçš„è¿ç§»ï¼ˆ8ä¸ªï¼‰ï¼š
1. 001_initial_schema.sql
2. 002_add_error_logs.sql
3. 003_add_openid_column.sql
4. 004_add_trade_type.sql
5. 004_extend_users_table.sql
6. 005_create_invite_records.sql
7. 006_create_invite_stats.sql
8. 007_create_usage_logs.sql

---

## ğŸ“Š ç”Ÿäº§ç¯å¢ƒç»Ÿè®¡

**æ€»è¡¨æ•°ï¼š36å¼ **

åˆ†ç±»ï¼š
- æ ¸å¿ƒä¸šåŠ¡è¡¨ï¼š10å¼ 
- ç®¡ç†åå°è¡¨ï¼š6å¼ 
- é‚€è¯·ç³»ç»Ÿè¡¨ï¼š3å¼ 
- å…¶ä»–ç³»ç»Ÿè¡¨ï¼š17å¼ ï¼ˆdeployflow_* ç³»åˆ—ï¼‰

---

## ğŸ” å°ç¨‹åºå…¼å®¹æ€§æ£€æŸ¥

**æ£€æŸ¥ç»“æœï¼šâœ… å®Œå…¨å…¼å®¹**

å°ç¨‹åºä½¿ç”¨çš„å­—æ®µï¼š
- userId âœ…
- openid âœ…
- paymentStatus âœ…

æ–°å¢å­—æ®µï¼ˆæš‚æœªä½¿ç”¨ä½†ä¸å½±å“åŠŸèƒ½ï¼‰ï¼š
- unionid, nickname, avatar_url
- level, status, daily_limit, used_today
- usage_count, invite_code, has_ever_paid

---

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼ˆå¿…é¡»ï¼‰
```bash
# SSH åˆ°ç”Ÿäº§æœåŠ¡å™¨
ssh root@106.54.62.162

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/ai-family-photo/backend

# åˆ›å»ºç®¡ç†å‘˜
node scripts/create-admin-user.js
```

é»˜è®¤è´¦æˆ·ï¼š
- ç”¨æˆ·åï¼šadmin
- å¯†ç ï¼šAdmin@123456
- âš ï¸ é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹å¯†ç 

### 2. éƒ¨ç½²ç®¡ç†åå°å‰ç«¯ï¼ˆå¯é€‰ï¼‰
```bash
# æœ¬åœ°æ„å»º
cd admin
pnpm run build

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r dist/* root@106.54.62.162:/var/www/admin/

# é…ç½® Nginx
# æ·»åŠ åå‘ä»£ç†é…ç½®
```

### 3. é…ç½®ä»·æ ¼ï¼ˆå¯é€‰ï¼‰
å½“å‰é»˜è®¤ä»·æ ¼ï¼š
- å…è´¹ç‰ˆï¼š0.00å…ƒ
- å°é²œåŒ…ï¼š9.90å…ƒ
- å°Šäº«åŒ…ï¼š29.90å…ƒ
- æ™¶ç“·ç”»ï¼š68.00å…ƒ
- å·è½´ï¼š128.00å…ƒ

å¯é€šè¿‡ç®¡ç†åå°ä¿®æ”¹ã€‚

---

## âœ… éªŒè¯æ¸…å•

- âœ… æœ¬åœ°æ•°æ®åº“ä¸ç”Ÿäº§ç¯å¢ƒå®Œå…¨åŒæ­¥
- âœ… æ‰€æœ‰è¿ç§»å·²æ‰§è¡Œåˆ°ç”Ÿäº§ç¯å¢ƒ
- âœ… ç®¡ç†åå°è¡¨å·²éƒ¨ç½²
- âœ… é‚€è¯·ç³»ç»Ÿè¡¨å·²éƒ¨ç½²
- âœ… å°ç¨‹åºä»£ç å…¼å®¹
- âœ… åˆå§‹æ•°æ®å·²æ’å…¥
- âœ… å¤–é”®çº¦æŸæ­£ç¡®
- âœ… ç´¢å¼•å·²åˆ›å»º

---

## ğŸ“ é‡è¦è¯´æ˜

1. **æ•°æ®åº“ç»“æ„å·²å®Œå…¨åŒæ­¥**
   - æœ¬åœ°å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒæ•°æ®ç»“æ„ä¸€è‡´
   - å¯ä»¥å®‰å…¨åœ°åœ¨ä¸¤ä¸ªç¯å¢ƒé—´åˆ‡æ¢

2. **å°ç¨‹åºåŠŸèƒ½ä¸å—å½±å“**
   - ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
   - æ–°å¢å­—æ®µä¸ºæœªæ¥åŠŸèƒ½é¢„ç•™

3. **ç®¡ç†åå°å·²å…·å¤‡æ•°æ®åŸºç¡€**
   - æ•°æ®åº“è¡¨å·²å°±ç»ª
   - å¯ä»¥å¼€å§‹éƒ¨ç½²å‰ç«¯

4. **é‚€è¯·ç³»ç»Ÿå·²å°±ç»ª**
   - ç›¸å…³è¡¨å·²åˆ›å»º
   - å¯ä»¥å¼€å§‹å¼€å‘é‚€è¯·åŠŸèƒ½

---

## ğŸ‰ æ€»ç»“

**æ‰€æœ‰æ•°æ®åº“åŒæ­¥ä»»åŠ¡å·²æˆåŠŸå®Œæˆï¼**

- ç”Ÿäº§ç¯å¢ƒè¡¨æ•°ï¼š36å¼ 
- è¿ç§»è®°å½•ï¼š8ä¸ª
- åˆå§‹æ•°æ®ï¼š5æ¡ä»·æ ¼é…ç½®
- çŠ¶æ€ï¼šç”Ÿäº§å°±ç»ª âœ…
