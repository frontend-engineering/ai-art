# 产品优化任务清单 v3.0

> **版本说明：** 本版本聚焦免费用户体验优化和分享功能增强  
> **更新时间：** 2026-01-30  
> **预计工期：** 3-5个工作日

---

## 一、核心策略调整

### 1.1 免费用户体验策略
**目标：** 降低免费用户的付费压力感，提升产品好感度

**核心原则：**
- 隐藏次数显示，避免焦虑感
- 在关键转化节点引导付费
- 通过水印而非限制来区分版本

---

## 二、功能优化清单

### 🎯 P0 - 高优先级（本周完成）

#### 2.1 免费用户次数显示优化
**需求背景：** 免费用户看到次数倒计时会产生焦虑，影响使用体验

**优化方案：**
- ✅ **隐藏次数显示**：免费用户（无充值记录）在所有页面不显示剩余次数
- ✅ **保留付费用户次数**：已付费用户继续显示次数，体现价值感

**影响页面：**
- `pages/transform/launch/launch.wxml` - 启动页
- `pages/puzzle/launch/launch.wxml` - 拼图启动页
- `pages/transform/result/result.wxml` - 结果页
- `pages/puzzle/result/result.wxml` - 拼图结果页

**实现逻辑：**
```javascript
// 判断是否显示次数
const shouldShowUsageCount = user.has_ever_paid === true;

// 在模板中条件渲染
<view wx:if="{{shouldShowUsageCount}}" class="usage-count">
  剩余次数：{{remainingCount}}
</view>
```

**验收标准：**
- [ ] 免费用户在所有页面看不到次数显示
- [ ] 付费用户正常显示次数
- [ ] 不影响后台次数扣减逻辑

---

#### 2.2 生成按钮交互优化
**需求背景：** 点击生成按钮时需要明确的反馈和引导

**优化方案：**
- ✅ **次数不足弹窗**：免费用户次数用尽时，点击生成按钮弹出套餐选择弹窗
- ✅ **弹窗内容优化**：突出付费价值，而非强调限制

**影响页面：**
- `pages/transform/launch/launch.js`

**弹窗文案设计：**
```
标题：解锁更多精彩功能
内容：
  ✨ 无水印高清原图
  ✨ 更多使用次数
  ✨ 4K超清画质（尊享版）
  ✨ 无广告纯净体验

按钮：
  [查看套餐] [邀请好友获取次数]
```

**验收标准：**
- [ ] 次数不足时点击生成按钮触发弹窗
- [ ] 弹窗文案突出价值而非限制
- [ ] 提供邀请好友的替代方案

---

#### 2.3 保存功能优化
**需求背景：** 免费用户保存时是关键转化节点

**优化方案：**
- ✅ **强制引导付费**：免费用户保存时，无论是否有次数，都弹出套餐选择
- ✅ **添加水印标识**：免费版图片保存时自动添加"团圆照相馆"水印（右下角）
- ✅ **付费用户无水印**：已付费用户保存时不添加水印

**影响页面：**
- `pages/transform/result/result.js`
- `pages/puzzle/result/result.js`

**实现逻辑：**
```javascript
// 保存按钮点击事件
onSaveImage() {
  if (!this.data.user.has_ever_paid) {
    // 免费用户：弹出套餐选择
    this.showPackageModal();
    // 同时保存带水印的图片
    this.saveImageWithWatermark();
  } else {
    // 付费用户：直接保存无水印图片
    this.saveImage();
  }
}
```

**水印规格：**
- 位置：右下角，距边缘20px
- 文字：团圆照相馆
- 字体：微软雅黑，16px
- 颜色：白色，透明度70%
- 阴影：黑色描边，增强可读性

**验收标准：**
- [ ] 免费用户保存时弹出套餐选择
- [ ] 免费用户保存的图片带水印
- [ ] 付费用户保存的图片无水印
- [ ] 水印位置和样式符合设计规范

---

### 🎯 P1 - 中优先级（下周完成）

#### 2.4 分享功能增强
**需求背景：** 当前分享功能不完善，被分享者无法看到分享内容

**优化方案：**
- ✅ **分享链接优化**：生成带参数的分享链接，包含 generation_id
- ✅ **被分享者视图**：点击分享链接后，跳转到 result 页面展示分享者的作品
- ✅ **分享者信息展示**：显示分享者昵称和头像（可选）

**影响页面：**
- `pages/transform/result/result.js` - 分享逻辑
- `pages/puzzle/result/result.js` - 分享逻辑
- 新增：分享参数解析逻辑

**技术方案：**

**A. 分享链接生成**
```javascript
// 分享时生成带参数的链接
onShareAppMessage() {
  return {
    title: '快来看看我的AI全家福！',
    path: `/pages/transform/result/result?shareId=${this.data.generationId}&from=share`,
    imageUrl: this.data.resultImageUrl
  };
}
```

**B. 被分享者页面逻辑**
```javascript
// result页面加载时检查分享参数
onLoad(options) {
  if (options.shareId && options.from === 'share') {
    // 从分享进入，加载分享者的作品
    this.loadSharedResult(options.shareId);
  } else {
    // 正常进入，加载自己的作品
    this.loadMyResult();
  }
}

// 加载分享的作品
async loadSharedResult(shareId) {
  const result = await api.getGenerationById(shareId);
  this.setData({
    isSharedView: true,
    resultData: result,
    showSaveButton: false, // 分享视图不显示保存按钮
    showShareButton: true  // 显示"我也要制作"按钮
  });
}
```

**C. 后端API支持**
```javascript
// 新增接口：根据ID获取生成结果（公开访问）
GET /api/generation/:id/public
// 返回：图片URL、模板信息（不返回用户敏感信息）
```

**验收标准：**
- [ ] 分享链接包含正确的参数
- [ ] 被分享者能看到分享者的作品
- [ ] 分享视图不显示保存按钮
- [ ] 提供"我也要制作"引导按钮
- [ ] 不泄露用户敏感信息

---

## 三、数据库支持

### 3.1 用户表字段确认
确保 `users` 表包含以下字段：
```sql
has_ever_paid BOOLEAN DEFAULT FALSE  -- 是否曾经付费
payment_status VARCHAR(20)           -- 当前套餐状态：free/basic/premium
```

### 3.2 生成记录表字段确认
确保 `generation_history` 表支持公开访问：
```sql
is_public BOOLEAN DEFAULT TRUE       -- 是否允许公开访问（用于分享）
share_count INT DEFAULT 0            -- 分享次数统计
```

---

## 四、测试计划

### 4.1 功能测试
- [ ] 免费用户次数显示隐藏测试
- [ ] 付费用户次数显示正常测试
- [ ] 生成按钮弹窗触发测试
- [ ] 保存功能水印添加测试
- [ ] 分享链接生成测试
- [ ] 被分享者视图加载测试

### 4.2 边界测试
- [ ] 免费用户次数为0时的各种操作
- [ ] 付费用户次数为0时的行为
- [ ] 分享链接参数异常处理
- [ ] 分享内容不存在时的处理

### 4.3 兼容性测试
- [ ] 不同机型的水印显示效果
- [ ] 不同网络环境的分享加载速度
- [ ] 新老用户数据兼容性

---

## 五、上线计划

### 5.1 开发阶段（3天）
- Day 1：次数显示优化 + 生成按钮优化
- Day 2：保存功能优化 + 水印功能
- Day 3：分享功能增强

### 5.2 测试阶段（1天）
- 功能测试
- 边界测试
- 用户体验测试

### 5.3 发布阶段（1天）
- 灰度发布（10%用户）
- 监控数据和反馈
- 全量发布

---

## 六、关键指标

### 6.1 用户体验指标
- 免费用户平均使用次数
- 免费用户转化率
- 分享功能使用率

### 6.2 商业指标
- 付费转化率变化
- 客单价变化
- 分享带来的新增用户数

---

## 七、风险评估

### 7.1 技术风险
- **水印功能**：需要前端或后端实现，评估性能影响
- **分享功能**：需要后端支持公开访问接口，注意安全性

### 7.2 产品风险
- **隐藏次数**：可能导致用户不清楚使用限制，需要在合适时机提示
- **强制引导付费**：可能引起用户反感，需要优化文案和体验

### 7.3 缓解措施
- 在首次使用时通过引导页说明免费规则
- 提供邀请好友的免费替代方案
- 优化弹窗文案，突出价值而非限制

---

**负责人：** 产品 + 开发团队  
**审核人：** 产品经理  
**预计完成时间：** 2026-02-07
