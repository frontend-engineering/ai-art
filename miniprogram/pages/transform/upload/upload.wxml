<!--
  富贵变身模式上传页 - 复用 puzzle upload 设计
  Requirements: 2.3, 6.1-6.5
-->
<view class="transform-upload-page page-with-nav {{isElderMode ? 'elder-mode' : ''}}">>
  <!-- 四角装饰背景 -->
  <corner-background />
  
  <!-- 背景 -->
  <image class="upload-bg-image" src="{{commonBgUrl}}" mode="aspectFill" />
  <view class="upload-bg"></view>
  
  <!-- 大小字切换按钮（右上角，胶囊按钮下方） -->
  <view class="elder-mode-toggle-fixed" style="top: {{statusBarHeight + navBarHeight + 16}}px; right: {{menuRight}}px; left: auto;">
    <elder-mode-toggle />
  </view>
  
  <!-- 顶部导航栏 -->
  <view class="nav-bar" style="padding-top: {{statusBarHeight}}px; height: {{statusBarHeight + navBarHeight}}px;">
    <view class="nav-left">
      <view class="back-btn" bindtap="goBack">
        <text class="back-icon">‹</text>
      </view>
    </view>
    <text class="nav-title">上传照片</text>
    <view class="nav-right"></view>
  </view>
  
  <!-- 主内容区 -->
  <view class="upload-content" style="padding-top: {{statusBarHeight + navBarHeight + 32}}px;">
    <!-- 标题说明 -->
    <view class="title-section">
      <text class="title-text">上传一张全家福</text>
      <text class="subtitle-text">AI将为您更换高端背景</text>
    </view>
    
    <!-- 错误提示 -->
    <view class="error-toast" wx:if="{{errorMessage && !isUploading}}">
      <text class="error-icon">⚠️</text>
      <text class="error-text">{{errorMessage}}</text>
      <view class="error-close" bindtap="clearError">
        <text class="close-icon">✕</text>
      </view>
    </view>
    
    <!-- 上传区域 -->
    <view 
      class="upload-area" 
      wx:if="{{!isUploading}}"
      bindtap="handleUploadClick"
      hover-class="upload-area-hover"
    >
      <!-- 上传提示 -->
      <view class="upload-prompt">
        <image class="camera-image" src="{{cameraUploadUrl}}" mode="scaleToFill" />
      </view>
    </view>
    
    <!-- 文本部分 - 在框外下方 -->
    <view class="upload-text-section" wx:if="{{!isUploading}}">
      <text class="upload-text">点击上传照片</text>
      <text class="upload-hint">支持 JPG、PNG 格式，最大 10MB</text>
      
      <!-- 示例提示 -->
      <view class="example-tips">
        <view class="tip-item">
          <text class="tip-icon">✓</text>
          <text class="tip-text">正面清晰照片</text>
        </view>
        <view class="tip-item">
          <text class="tip-icon">✓</text>
          <text class="tip-text">人脸完整可见</text>
        </view>
        <view class="tip-item">
          <text class="tip-icon">✓</text>
          <text class="tip-text">光线充足</text>
        </view>
      </view>
    </view>
    
    <!-- 底部提示 -->
    <view class="bottom-tips" wx:if="{{!isUploading}}">
      <text class="tips-text">💡 提示：上传清晰的正面照片效果更好</text>
    </view>
    
    <!-- AI生成提示（合规要求） -->
    <view class="ai-notice" wx:if="{{!isUploading}}">
      <text class="ai-notice-text">本服务为AI生成内容，结果仅供参考</text>
    </view>
  </view>
  
  <!-- 上传中状态 - 页面居中 -->
  <view class="uploading-state" wx:if="{{isUploading}}">
    <view class="loading-spinner">
      <loading showText="{{false}}" />
    </view>
    <text class="status-text">{{statusText}}</text>
    <view class="progress-bar" wx:if="{{uploadProgress > 0 && uploadProgress < 100}}">
      <view class="progress-fill" style="width: {{uploadProgress}}%"></view>
    </view>
  </view>
  
  <!-- 支付弹窗 -->
  <payment-modal
    visible="{{showPaymentModal}}"
    currentPaymentStatus="{{currentPaymentStatus}}"
    bind:complete="handlePaymentComplete"
    bind:close="handlePaymentClose"
  />
</view>
