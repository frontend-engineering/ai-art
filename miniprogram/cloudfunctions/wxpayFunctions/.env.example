# 微信云函数环境变量配置
# 请在微信云开发控制台 → 云函数 → wxpayFunctions → 配置 → 环境变量中配置

# MySQL 数据库连接字符串
# 格式: mysql://用户名:密码@主机:端口/数据库名
DATABASE_URL=mysql://username:password@host:port/database

# ========== Native 支付配置（PC 扫码支付） ==========
# 微信支付商户号
WECHAT_MCHID=your_mchid

# 微信 AppID
WECHAT_APPID=your_appid

# 商户证书序列号（40位十六进制字符）
# 获取方式：微信商户平台 → API安全 → API证书 → 查看证书
WECHAT_SERIAL_NO=your_serial_no

# 商户私钥（API 证书私钥）
# 重要：必须使用 \n 表示换行符，不能使用真实换行
# 格式：-----BEGIN PRIVATE KEY-----\n私钥内容\n-----END PRIVATE KEY-----
# 
# 从 apiclient_key.pem 文件转换：
# cat apiclient_key.pem | tr '\n' '|' | sed 's/|/\\n/g'
# 
# 示例（单行格式）：
# WECHAT_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASC...\n-----END PRIVATE KEY-----
WECHAT_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nYour Private Key\n-----END PRIVATE KEY-----

# 微信支付平台公钥证书（可选，用于验证回调签名）
# 格式：-----BEGIN CERTIFICATE-----\n证书内容\n-----END CERTIFICATE-----
# 
# 获取方式：
# 1. 微信商户平台 → API安全 → 平台证书 → 下载证书
# 2. 或使用微信支付证书工具下载
# 
# 从证书文件转换：
# cat wechatpay_certificate.pem | tr '\n' '|' | sed 's/|/\\n/g'
# 
# 注意：如果不配置，SDK 会在首次调用时自动从微信服务器获取
WECHAT_PUBLIC_KEY=-----BEGIN CERTIFICATE-----\nYour Certificate\n-----END CERTIFICATE-----

# APIv3 密钥（32位字符串）
# 获取方式：微信商户平台 → API安全 → APIv3密钥 → 设置密钥
WECHAT_APIV3_KEY=your_apiv3_key

# 支付回调通知 URL（必需！）
# 微信支付成功后会调用此地址通知订单状态
# 
# 使用云函数 HTTP 触发器地址（推荐）
# 格式：https://your-env.api.tcloudbasegateway.com/pay
# 
# 示例（根据你的环境配置）：
# WECHAT_NOTIFY_URL=https://test-1g71tc7eb37627e2.api.tcloudbasegateway.com/pay
# 
# 如果不配置此项，可以配置 API_BASE_URL，系统会自动生成回调地址
# 如果两者都不配置，将使用占位符地址，需要手动查询订单状态
WECHAT_NOTIFY_URL=https://your-env.api.tcloudbasegateway.com/pay

# 后端 API 基础 URL（用于价格查询和回调通知）
# 如果配置了此项但未配置 WECHAT_NOTIFY_URL，回调地址将自动生成为：
# API_BASE_URL + /api/payment/callback
# 
# 示例：http://111.231.6.34
API_BASE_URL=https://your-api-domain.com

# 内部 API 密钥（可选，用于云函数与后端服务器之间的安全通信）
# 如果配置了此项，云函数通知后端时会在请求头中携带此密钥
# 后端可以验证此密钥以确保请求来自可信的云函数
# 
# 建议：生成一个随机字符串作为密钥
# 示例：openssl rand -hex 32
INTERNAL_API_SECRET=your-secret-key-here
